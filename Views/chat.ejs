<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <title>IGIT Chatbot App</title>
        <!--<script src="https://use.fontawesome.com/releases/v6.3.0/js/all.js" crossorigin="anonymous"></script>-->
        <link href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700,800,900" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
		    <!--<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">-->
        <link href="/css/styles.css" rel="stylesheet" />    
           
    </head>
    <body class="sb-nav-fixed" style="background-color: #f7f7f8;">
        <nav class="sb-topnav navbar navbar-expand navbar-dark">
            <!-- Navbar Brand-->
            <a class="navbar-brand ps-3 font-weight-bold" href="/" style="font-weight: 600;">IGIT ChatGPT</a>
            <!-- Sidebar Toggle-->
            <button class="btn btn-link btn-sm order-1 order-lg-0 me-4 me-lg-0" id="sidebarToggle" href="#!"><i class="fa fa-bars"></i></button>
            <!-- Navbar Search-->
            <form class="d-none d-md-inline-block form-inline ms-auto me-0 me-md-3 my-2 my-md-0">
            </form>
            <!-- Navbar-->
            <ul class="navbar-nav ms-auto ms-md-0 me-3 me-lg-4">
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" id="navbarDropdown" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false"><i class="fa fa-user fa-fw"></i></a>
                    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarDropdown">
                        <li><a class="dropdown-item" href="#!">Settings</a></li>
                        <li><a class="dropdown-item" href="#!">Activity Log</a></li>
                        <li><hr class="dropdown-divider" /></li>
                        <li><a class="dropdown-item" href="#!">Logout</a></li>
                    </ul>
                </li>
            </ul>
        </nav>
        <div id="layoutSidenav">
            <div id="layoutSidenav_nav">
                <nav class="sb-sidenav accordion sb-sidenav-dark" id="sidenavAccordion">
                    <div class="sb-sidenav-menu">
                        <h3 class="text-white text-center" href="/" style="font-weight: 500; font-size: 20px; padding: 20px 0px 0px 0px;">IGIT ChatGPT</h3>
                        <div class="nav px-3">
                            
                            <a class="nav-link mt-3 mb-3" href="/chatgpt/newchat" style="border: 1px solid rgba(255, 255, 255, 0.5); padding:7px 12px; border-radius: 5px;">
                                <div class="sb-nav-link-icon"><i class="fa fa-plus"></i></div>
                                New Chat
                            </a>
                            <% if(history.length >= 1){ %>
                              <a class="btn btn-sm text-white mb-3" style="border: 1px solid #bbbcc2">Search History</a>
                              <% for(var i = 0; i < history.length; i++) {%>
                                <a href="" class="text-white mb-2" style="font-size: 14px;text-decoration: none; overflow: hidden;"><i class="fa-regular fa-message" style="margin-right: 7px;"></i><%= history[i].question %></a>
                              <%}%>
                            <%}%>
                        </div>
                    </div>
                    <div class="sb-sidenav-footer">
                        <div class="small">Logged in as:</div>
                         <small style="font-size: 11.5px;font-weight: 600;"><%= email %></small>
                         <a href="/user/logout" class="btn btn-sm text-white w-100 mt-2" style="border: 1px solid #bbbcc2;">Logout</a>
                    </div>
                </nav>
            </div>
            <div id="layoutSidenav_content">
                <main>
                    <div class="container-fluid px-4" style="margin-bottom: 150px;">
                        <div class="row">
                            <div class="col-md-12">
                                <% if(data.length >= 1){ %>
                                  <% for(var i = 0; i < data.length; i++) {%> 
                                    
                                      <div class="chat-view" id="chatview">
                                        <div class="question-section" style="background-color: #fff; padding: 20px 0px; border: 1px solid rgba(0,0,0,.1); margin: 20px 0px; border-radius:5px;">
                                          <div class="col-md-7 mx-auto">
                                            <span class="mx-3"><img src="/images/user.png" alt="" style="height: 30px; width:30px"></span><span style="font-size: 16px; font-family:system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif; font-weight: 500;color: #4f505a;"><%= data[i].question %></span>
                                        </div> 
                                       </div>
                                       <div class="answer-section my-4">
                                          <div class="col-md-7 mx-auto">
                                           <div class="discord">
                                            <span class="mx-3">
                                              <% 
                                              let id = i
                                              if(i+1 == data.length) {
                                               id = "typewriter"
                                              }
                                              %>
                                              <img src="/images/bot.png" alt="" style="height: 30px; width:30px"></span>
                                              <span class="typewriter" id="<%= id %>">
                                                <%= data[i].answer %>                                              
                                              </span>
                                              </div>
                                        </div> 
                                       </div>
                                      </div>
                                  
                                  <%}%> 
                                <%}else{%>
                                <div id="content" class="text-center" style="margin-top:90px;">
                                    <h2 class="mb-3 font-weight-bold">IGIT ChatGPT</h2>
                                    <div class="col-md-8 mx-auto">
                                        <div class="card mt-4" style="border: 0px solid #ccc;background-color: #f7f7f8;">
                                            <div class="card-body">
                                               <div class="row">
                                                <div class="col-md-4">
                                                    <div class="header-image my-3">
                                                        <img src="/images/sunny-day.png" alt="" style="height:30px; width: 30px;">
                                                    </div>                                  
                                                    <div class="header-text">
                                                     <h5>Examples</h5>
                                                  </div>
                                                  <div class="section-ex mt-3" style="background-color: #efefef; border-radius: 5px; padding: 8px; color: #111;">
                                                    <span>"Explain Quantum computing in simple term" &#8594;</span>
                                                  </div>
                                                  <div class="section-ex mt-3" style="background-color: #efefef; border-radius: 5px; padding: 8px; color: #111;">
                                                    <span>"Suggest me an idea for 10 years old birthday" &#8594;</span>
                                                  </div>
                                                  <div class="section-ex mt-3" style="background-color: #efefef; border-radius: 5px; padding: 8px; color: #111;">
                                                    <span>"How Jquery Get and Post method works" &#8594;</span>
                                                  </div>
                                                </div>
                                                <div class="col-md-4">
                                                    <div class="header-text">
                                                        <div class="header-image my-3">
                                                            <img src="/images/power.png" alt="" style="height:30px; width: 30px;">
                                                        </div>
                                                       <h5>Capabilities</h5>
                                                    </div>
                                                    <div class="section-ex mt-3" style="background-color: #efefef; border-radius: 5px; padding: 8px; color: #111;">
                                                      <span>"Explain Quantum computing in simple term" &#8594;</span>
                                                    </div>
                                                    <div class="section-ex mt-3" style="background-color: #efefef; border-radius: 5px; padding: 8px; color: #111;">
                                                      <span>"Suggest me an idea for 10 years old birthday" &#8594;</span>
                                                    </div>
                                                    <div class="section-ex mt-3" style="background-color: #efefef; border-radius: 5px; padding: 8px; color: #111;">
                                                      <span>"How Jquery Get and Post method works" &#8594;</span>
                                                    </div>
                                                  </div>
                                                  <div class="col-md-4">
                                                    <div class="header-text">
                                                        <div class="header-image my-3">
                                                            <img src="/images/danger.png" alt="" style="height:30px; width: 30px;">
                                                        </div>
                                                       <h5>Limitations</h5>
                                                    </div>
                                                    <div class="section-ex mt-3" style="background-color: #efefef; border-radius: 5px; padding: 8px; color: #111;">
                                                      <span>"May ocassionally generate fake information" &#8594;</span>
                                                    </div>
                                                    <div class="section-ex mt-3" style="background-color: #efefef; border-radius: 5px; padding: 8px; color: #111;">
                                                      <span>"May ocasionally produce harmful content" &#8594;</span>
                                                    </div>
                                                    <div class="section-ex mt-3" style="background-color: #efefef; border-radius: 5px; padding: 8px; color: #111;">
                                                      <span>"Limited knowledge of world and tasks" &#8594;</span>
                                                    </div>
                                                  </div>
                                               </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <%}%>
                            </div>
                        </div>
                    </div>
                </main>
                <footer class="py-4 bg-light mt-auto position-fixed" style="bottom: 0; width: 100%; left:0px;">
                    <div class="container-fluid px-4">
                        <div class="align-items-center justify-content-center small">
                            <div class="row">
                                <div class="col-md-6 mx-auto text-center">
                                  <form action="/chatgpt/new" method="post">
                                    <div class="input-group mb-2" id="textinput">
                                      
                                        <input type="text" name="message" class="form-control" id="message" placeholder="Send a message." aria-label="Send a message." aria-describedby="basic-addon2" style="padding: 10px 8px; border-radius: 6px;">
                                        <div class="input-group-append">
                                          <button class="btn btn-outline-secondary" id="chat" type="submit" style="background-color: #fff; color: #ccc;border: 1px solid #fff;cursor: pointer; padding: 8px 13px 0px 0px; margin-left: -35px; z-index: 1000;"><i class="fa-regular fa-paper-plane"></i></button>
                                          <span class="form-control-feedback" id="voice" style="position: relative; left: 15px; top: 2px; cursor: pointer;" onclick="runSpeechRecognition()"><img src="/images/mic.png" alt="" style="height:40px; width: 40px;"></span>                                           
                                        </div>
                                        <span id="voicerecord" style="position: fixed; right: 158px;bottom: 70px;"></span>
                                      </div>
                                    </form>
                                     <span class="text-sm text-center" style="font-size: 11px; color: #bbbcc2;">Free Research Preview. IGITChatGPT may produce inaccurate information about people, places, or facts. version 1.0.0</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </footer>
            </div>
        </div>
        <script src="/js/jquery.min.js"></script> 
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
        <script src="/js/scripts.js"></script>
        <script>
            const buttonEl = document.getElementById('voice');
            const message = document.getElementById('message');
            function runSpeechRecognition() {
		        var output = document.getElementById("message");
		        var action = document.getElementById("voicerecord");
                var SpeechRecognition = SpeechRecognition || webkitSpeechRecognition;
                var recognition = new SpeechRecognition();
                recognition.onstart = function() {
                    action.innerHTML = "<small style='color:green;' id='voice1'>We are listening...</small>";
                };
                
                recognition.onspeechend = function() {
                    action.innerHTML = "<small style='color:red;' id='voice2'>Stopped listening...</small>";
                    recognition.stop();
                }
                recognition.onresult = function(event) {
                    var transcript = event.results[0][0].transcript;
                    var confidence = event.results[0][0].confidence;
                    output.value = transcript;
                    output.classList.remove("hide");
                };
                 recognition.start();
                 setTimeout(function(){
                  document.getElementById("voice2").style.display = "none";  
                }, 8000);
	        }
        </script>
        <script>
         $(document).ready(function() {
          var text = $("#typewriter").text();
          $("#typewriter").text("");
          var timer = setInterval(function() {
            $("#typewriter").text(function(_, oldText) {
              return oldText + text.charAt($(this).text().length);
            });
            if ($("#typewriter").text() === text) {
              clearInterval(timer);
            }
          }, 50);
        });
        </script>
    </body>
</html>
